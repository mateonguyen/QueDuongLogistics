<div>
	<nav aria-label="Breadcrumbs" class="breadcrumbs container-fluid">
		<div class="breadcrumbs-container">
			<h4 class="mr-2">LỆNH ĐIỀU VẬN</h4>
			<div><a>
					<svg-icon [name]="'truck-fast'" [width]="20" [height]="16" class="align-baseline"></svg-icon>
				</a></div>
		</div>
	</nav>
</div>
<div class="container-fluid">
	<main class="content" id="content-body">
		<div class="flash-container flash-container-page" *ngIf="this.globalError">
			<div class="flash-alert mb-2">
				<svg-icon [name]="'error'" [size]="16" [className]="'mr-1 align-middle d-inline'"></svg-icon>
				<span class="align-text-top">{{ this.globalError }}</span>
				<div class="close-icon-wrapper js-close-icon">
					<svg-icon [name]="'close'" [size]="16" class="align-baseline"></svg-icon>
				</div>
			</div>
		</div>
		<form #editForm="ngForm" (ngSubmit)="editForm.valid && save()">
			<button type="submit" class="btn btn-success" [disabled]="!editForm.valid">Tạo điều vận</button>
			<div class="row mt-2">
				<div class="col-lg-4">
					<app-transaction-customer-select [(customer)]="transaction.customer"
						[(transactionCode)]="transaction.transactionNo"
						(change)="onCustomerChange($event)"></app-transaction-customer-select>
				</div>

				<div class="col-lg-4">
				</div>

				<div class="col-lg-4">
					<!-- <app-transaction-vendor-select></app-transaction-vendor-select> -->
				</div>

			</div>

			<div class="row mt-2">
				<div class="col-lg-4">
					<app-transaction-driver-select [(model)]="transaction.driver"
						(change)="onDriverChange($event)"></app-transaction-driver-select>
				</div>

				<div class=" col-lg-4">
					<app-transaction-vehicle-select [(model)]="transaction.vehicle"
						(change)="onVehicleChange($event)"></app-transaction-vehicle-select>
				</div>

				<div class="col-lg-4">
					<app-transaction-shipping-route-select [(model)]="transaction.shippingRoute"
						(change)="onShippingRouteChange($event)"></app-transaction-shipping-route-select>
				</div>

			</div>

			<div class="row mt-2">
				<nz-table #table [classList]="'border-spacing-y-[10px]'" [nzSize]="'small'"
					[nzData]="transaction.transactionDetails" nzTableResponsive>
					<thead>
						<tr role="row">
							<th class="whitespace-nowrap" nzColumnKey="contType" [nzSortFn]="true" style="width: 3%;">Loại cont</th>
							<th class="whitespace-nowrap" nzColumnKey="contCount" [nzSortFn]="true" style="width: 1%;">Số cont</th>
							<th class="whitespace-nowrap" nzColumnKey="packageCount" [nzSortFn]="true" style="width: 1%;">Số kiện</th>
							<th class="whitespace-nowrap" nzColumnKey="packageUnit" [nzSortFn]="true" style="width: 5%;">ĐVT Kiện</th>
							<th class="whitespace-nowrap" nzColumnKey="quantity" [nzSortFn]="true" style="width: 1%;">Số lượng</th>
							<th class="whitespace-nowrap" nzColumnKey="unit" [nzSortFn]="true" style="width: 5%;">ĐVT</th>
							<th class="whitespace-nowrap" nzColumnKey="goodsDescription" [nzSortFn]="true" style="width: 20%;">Mô tả
								hàng hóa</th>
							<th class="whitespace-nowrap" nzColumnKey="deliveredPlace" [nzSortFn]="true" style="width: 8%;">Nơi giao
							</th>
							<th class="whitespace-nowrap" nzColumnKey="deliveredTime" [nzSortFn]="true" style="width: 8%;">Thời gian
								giao</th>
							<th class="whitespace-nowrap" style="width: 1%;"><button type="button" class="btn btn-success"
									(click)="openEditModal()">Thêm mới</button></th>
						</tr>
					</thead>
					<tbody>
						<tr *ngFor="let row of transaction.transactionDetails">
							<td>{{ row.contType }} </td>
							<td>{{ row.contCount }} </td>
							<td>{{ row.packageCount }} </td>
							<td>{{ row.packageUnit }} </td>
							<td>{{ row.quantity }} </td>
							<td>{{ row.unit }} </td>
							<td>{{ row.goodsDescription }} </td>
							<td>{{ row.deliveredPlaceId }} </td>
							<td>{{ parseHumanDate(row.deliveredTime) }} </td>
							<td>
								<button type="button" class="btn-link" (click)="openEditModal(row)">
									<svg-icon [name]="'pencil'" [size]="14"></svg-icon>
								</button>
								<span class="px-2">&nbsp;</span>
								<button type="button" class="btn-link text-danger" (click)="confirmDelete(row)">
									<svg-icon [name]="'remove'" [size]="14"></svg-icon>
								</button>
							</td>
						</tr>
					</tbody>
				</nz-table>
			</div>

			<div class="row mt-2">
				<div class="col-lg-6">
					<table class="table table_price table-bordered">
						<thead>
							<tr>
								<th class="whitespace-nowrap">Chi phí phát sinh</th>
								<th class="whitespace-nowrap">Giá</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>Phí lưu ca</td>
								<td>
									<input type="text" class="form-input" name="demurrageFee" [(ngModel)]="transaction.demurrageFee">
								</td>
							</tr>
							<tr>
								<td>Phí ghép điểm</td>
								<td>
									<input type="text" class="form-input" name="transshipmentFee"
										[(ngModel)]="transaction.transshipmentFee">
								</td>
							</tr>
							<tr>
								<td>Phí hàng về</td>
								<td>
									<input type="text" class="form-input" name="returnShippingFee"
										[(ngModel)]="transaction.returnShippingFee">
								</td>
							</tr>
							<tr>
								<td>Phí hải quan</td>
								<td>
									<input type="text" class="form-input" name="customsFee" [(ngModel)]="transaction.customsFee">
								</td>
							</tr>
							<tr>
								<td>Phí bốc xếp</td>
								<td>
									<input type="text" class="form-input" name="handlingFee" [(ngModel)]="transaction.handlingFee">
								</td>
							</tr>
							<tr>
								<td>Vé</td>
								<td>
									<input type="text" class="form-input" name="ticketFee" [(ngModel)]="transaction.ticketFee">
								</td>
							</tr>
							<tr>
								<td>Phát sinh khác</td>
								<td>
									<input type="text" class="form-input" name="otherFee" [(ngModel)]="transaction.otherFee">
								</td>
							</tr>
						</tbody>
						<tfoot>
							<tr role="row">
								<th class="whitespace-nowrap">Tổng</th>
								<th class="whitespace-nowrap">0</th>
							</tr>
						</tfoot>
					</table>
				</div>
				<div class="col-lg-6">
					<table class="table table_price table-bordered">
						<thead>
							<tr>
								<th class="whitespace-nowrap">Biên bản giao hàng</th>
								<th class="whitespace-nowrap">Giá</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>Lái xe nộp đủ về VP</td>
								<td>
									<input type="text" class="form-input" name="docManager" [(ngModel)]="transaction.docManager">
								</td>
							</tr>
							<tr>
								<td>Trả người quản lý giấy tờ</td>
								<td>
									<span *ngFor="let option of optionRadioBox">
										<input type="radio" name="isSummitedDoc" [(ngModel)]="transaction.isSummitedDoc"
											[value]="option.value">
										{{ option.label }}
										&nbsp;&nbsp;&nbsp;
									</span>
								</td>
							</tr>
							<tr>
								<td>Trả khách hàng</td>
								<td>
									<span *ngFor="let option of optionRadioBox">
										<input type="radio" name="isCustomerReturn" [(ngModel)]="transaction.isCustomerReturn"
											[value]="option.value">
										{{ option.label }}
										&nbsp;&nbsp;&nbsp;
									</span>
								</td>
							</tr>
						</tbody>
						<tfoot>
							<tr role="row">
								<th class="whitespace-nowrap">Tổng</th>
								<th class="whitespace-nowrap">0</th>
							</tr>
						</tfoot>
					</table>

					<table class="table table_price table-bordered mt-2">
						<thead>
							<tr>
								<th class="whitespace-nowrap">Ghi chú</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td><textarea rows="5" class="form-input" name="notes" [(ngModel)]="transaction.notes"></textarea></td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</form>
	</main>
</div>